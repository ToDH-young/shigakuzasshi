# 史学雑誌スクリプト整理用
## 目的
   このメモでは、cinii_articles.pyとcinii_books.pyという類似の挙動を示す2つのスクリプトについて、共通項を整理したり、モジュール化とかできないかを考えたりします  

## どうするか/どうしたいか？
共通機能をcinii_api.pyなどといった形で別ファイルで一括するなら、モジュール化について調べておく必要がある  
(この部分は要相談)  
    クラスにするという手もある  
    class CiNiiで、書籍の際のメソッドを用意するとか？       


## 挙動の理解
まずはそれぞれが何をしているのかをテキストではっきりさせる  
主として最初の三重引用符コメントを参照する  
関数にはF:とつける

1. articles
    1. Google Spreadsheetの認証
    2. URL・シートの指定とissn/keyのリスト作成
    3. CiNii ArticlesのAPIを自動生成
    4. F: jsonから各要素を取得する
    5. F:タイトルの取得
        5.1. F:タイトルの加工
    6. F: 年月の取得
        6.1. F: 年月の加工
    7. F: 著者の取得
        7.1. F: 著者の加工
    8. F: 雑誌名の取得
        8.1. F: 雑誌名の加工
    9. F: 巻号の取得
    10. F: 開始ページの取得
    11. F: 終了ページの取得
    12. F: 雑誌URLからAPI返り値を取得、辞書に変形
    13. F: JSONから個別の論文のURLを取得
    14. F: 論文URLからAPI返り値を取得、詳細データの入った記事単位の辞書を作成
    15. for文で回す

2. Books
    1. 出版社リストの指定
    2. 出力ファイルを指定
    3. F: 出版社リストからCiNii BooksのAPI返り値を取得するURLを作成する
    4. F: API返り値を取得しJSONを辞書に変形
    5. F: 出版社の出版物一覧の辞書から個別の書籍のURLを取得
    6. F: タイトルの加工
    7. F: 著者情報の加工
    8. F: 日付情報の加工
    9. F: ISBNを取得
    10. F: 過去の出版状況を参照し重複しないものだけ返す
    11. for文で各要素を取得しつつ書き込み

## 比較
上述の挙動を踏まえて共通項を洗い出す  

### 共通項
1. 加工
    Articlesの方が項目は多いものの、要素の加工は類似
2. 一覧から個別のURLを取得する
    雑誌->論文と出版社->書籍と、渡されたものからIDを参照する部分は同じ  
        -> IDの場所が同じであれば共通化可能  
3. JSONデータを受け取り辞書化する
4. リストからAPI返り値を要求するURLを指定する
    これも出版社リストか雑誌名-ISSNからなる辞書かの違いはあるものの、共通のプロセス  
    isinstance()を使えるのではないか。デコレータとまでは言わなくとも共通化はできそう  
    

### 違い
1. 情報の取得
    Articlesはそれぞれの情報を関数で定義し取得  
    -> それに対してBooksは、加工のみ  
2. Google APIの使用
3. ISBNの取得・過去の出版状況の参照
    これは書籍のみ  
    ただし、論文も過去の掲載状況を参照する仕組みがあれば類似のものは使う  

## 共通化作業
1. 共通項#2について
情報の取得に関しては、JSONでの参照場所が同じかどうかという比較作業が必要  

2. 加工作業
一通り作成しておいて適宜呼び出す？

3. 共通化そのもの
CiNii()のようなクラスを作ってそのモジュールとして呼び出す？  
それとも純粋に関数だけ作っておいてそれを呼び出す？  
どちらがいいのか、特に前者はどのようなgitメリットがあるのか調べる  
